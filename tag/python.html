<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Drug Discovery in Python - python</title>
        <link rel="stylesheet" href="https://russodanielp.github.io/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://russodanielp.github.io/">Drug Discovery in Python </a></h1>
                <nav><ul>
                    <li><a href="https://russodanielp.github.io/pages/curriculum-vitae.html">Curriculum Vitae</a></li>
                    <li><a href="https://russodanielp.github.io/pages/presentations.html">Presentations</a></li>
                    <li><a href="https://russodanielp.github.io/pages/publications.html">Publications</a></li>
                    <li><a href="https://russodanielp.github.io/pages/teaching.html">Teaching</a></li>
                    <li><a href="https://russodanielp.github.io/pages/about-me.html">About Me</a></li>
                    <li><a href="https://russodanielp.github.io/category/python.html">Python</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="https://russodanielp.github.io/creating-a-color-gradient-using-a-bezier-curve.html">Creating a Color Gradient Using a Bezier curve</a></h1>
<footer class="post-info">
        <abbr class="published" title="2016-11-18T17:48:00-05:00">
                Published: Fri 18 November 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://russodanielp.github.io/author/daniel-p-russo.html">Daniel P. Russo</a>
        </address>
<p>In <a href="https://russodanielp.github.io/category/python.html">Python</a>.</p>
<p>tags: <a href="https://russodanielp.github.io/tag/python.html">python</a> </p>
</footer><!-- /.post-info --><p>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Molecule properties and activities are most often represented in continuous, real values (e.g., EC<sub>50</sub>, IC<sub>50</sub>, LD<sub>50</sub>, LogP, etc.).  Usually for graphs I convert these values into discrete classifications (e.g., active/inactive, toxic/non-toxic, soluble/insoluble, etc.).  When making a new graph I can represent a molecule's properties or activities using a set of a few colors (red for active, green for inactive, etc).  Pretty straight forward stuff.  However, if I wanted to color the compound's real value it'd be a little more difficult; I would need a color gradient.  For example, the most active compounds the color would be red and the least active would be green.  Molecules that fall inbetween would be a color that is a mix between red and green, more red for more active and vice versa.</p>
<p>Apparently, none of the plotting packages (Bokeh, matplotlib, Plotly, seaborn) have this feature in their color libraries.  At least nothing I could find that allows you to set the colors from any two colors you choose.  Something similar I found was allowing you to import a "spectrum" of colors.  A discrete set of blues, for example, that go from dark blue to light blue.  However, this is not suitable for the infinite number of values that a LogP or LD<sub>50</sub> could take.</p>
<p>I took to the internet and found a great <a href="http://bsou.io/posts/color-gradients-with-python">blog post</a> by Ben Southgate, which I'll sumarize here.  In it he lays down the framework how to use <a href="https://en.wikipedia.org/wiki/B%C3%A9zier_curve">Bezier curves</a> create a color gradient between any number of colors.  Unfortunately, the code he wrote generates a discrete set of color values, so in this post I'll change it up to accept any real value between $0$ and $1$.</p>
<p>First, let's think about color as an RGB value, which is simply a vector in 3-dimensional space <code>[R, G, B]</code>, and let's plot that out.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.plotly</span> <span class="k">as</span> <span class="nn">py</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>


<span class="n">red</span> <span class="o">=</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">green</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">blue</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">]</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span><span class="p">]</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">:</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
                                <span class="n">x</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">y</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                <span class="n">z</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                                            <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                                            <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span>
                                            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                                            <span class="n">width</span><span class="o">=</span><span class="mi">1</span>
                                                    <span class="p">)</span>
                                            <span class="p">)</span>
                                    <span class="p">)</span>
                        <span class="p">)</span>
    
<span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
<span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[36]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;" seamless="seamless" src="https://plot.ly/~russodanielp/36.embed" height="525px" width="100%"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So now, being in 3D color space and all, it's pretty easy to see that you could generate an infinite amount of colors from red to green by simply drawing a line from the red circle located at $[255, 0, 0]$ to the green circle $[0, 255, 0]$.  If we define a variable $t \in [0,1]$, it can be thought of the distance traveled on the line from red to green.  When $t = 0.5$, we're halway from red to green.  If we do this linearly, we get an equation like this:</p>
$$color(t) = [255, 0, 0] + t\times([0, 255, 0]-[255, 0, 0])$$<p>Which is an easy function to code using numpy.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">linear_color</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; returns a color at distance t from color 1 to color 2 </span>
<span class="sd">    </span>
<span class="sd">    t: floating point between [0,1]</span>
<span class="sd">    colors: list of two colors    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">,</span> <span class="n">colors</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Any molecule activity, when scaled to be $[0,1]$ would then have a color on this gradient line. We can see what that would look like for one hundered values traveling from red to green.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">colors_red_to_green</span> <span class="o">=</span> <span class="p">[</span><span class="n">linear_color</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">])</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ts</span><span class="p">]</span>
<span class="n">line_data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors_red_to_green</span><span class="p">:</span>
    <span class="n">line_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
                                <span class="n">x</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">y</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                <span class="n">z</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                                            <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                                            <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span>
                                            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                                            <span class="n">width</span><span class="o">=</span><span class="mi">1</span>
                                                    <span class="p">)</span>
                                            <span class="p">)</span>
                                    <span class="p">)</span>
                        <span class="p">)</span>
    
<span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">+</span><span class="n">line_data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
<span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[38]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;" seamless="seamless" src="https://plot.ly/~russodanielp/38.embed" height="525px" width="100%"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The problem with that is that it's pretty ugly for inconclusive colors, that is molecules that are equidistant between active and inactive.  Let's say we wanted to have these colors take on a nicer blue color to show moderate activity.  We can do that if we take a detour in our 3D space.  Instead of linearly traveling from red to green, let's go around the ugly colors and approach the blue space.  To do that, we can use a Bezier curve.  A Bezier curve can create a nice smooth curve, given $n$ control points that dictate its shape.  As an example, we can use the red, blue, and green as our control points.  What the Bezier curve essentially does is it draws two lines, one from red to blue, the other from blue to green.  If $t$ is a point on each of these lines starting at $0$ (the green point for the first line and the blue for the second) the Bezier curve is the curve that connects these two points as $t$ travels from $0$ to $1$ along the lines.  This is much easier to understand when demonstrated visually, so <a href="https://www.jasondavies.com/animated-bezier/">here</a> is a nice interactive I found that shows how a Bezier curve can be drawn for an arbitrary number of control points at any distance.  Mathematically, the equation looks like this for n+1 control colors, where $P$ is a control color:</p>
$$B(t) = \sum\limits_{i=1}^n b_{i,n} (t)P_{i}$$<p>$b_{i,n}(t)$ is the Bernstein coefficient defined as</p>
$$b_{i,n}(t) = \bigg(\frac{n!}{i!(n-i)!}\bigg)t^i(1-t)^{n-i}$$<p>So, what that would look like for our three control points <code>[red, blue, green]</code>, would be this:</p>
$$ B(t) = b_{0,2}(t)[255, 0, 0] + b_{1,2}(t)[0, 0, 255] + b_{2,2}(t)[0, 255, 0] $$<p>Using these equations, we can write two functions that can calculate a color for any point $t$ given any number of control points.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">bernstein_coefficient</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; return the bernstein_constant for a Bezier curve</span>
<span class="sd">    </span>
<span class="sd">    t: floating point between [0,1]</span>
<span class="sd">    i: int between [0,n]</span>
<span class="sd">    n: number of control points</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">math</span>
    <span class="n">term1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">))</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">term1</span><span class="o">*</span><span class="n">term2</span>

<span class="k">def</span> <span class="nf">bezier_point</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">control_points</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Return RGB values for a point on a bezier curve given at t given a list of control points</span>
<span class="sd">    </span>
<span class="sd">    t: floating point between [0,1]</span>
<span class="sd">    control_points: list of control points, which should be in three dimensions (R,G,B)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">control_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">,</span> <span class="n">control_points</span><span class="p">))</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">bernstein_coefficient</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">control_points</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">pnt</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pnt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">control_points</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">pnt</span><span class="p">))</span> <span class="k">for</span> <span class="n">pnt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">result</span><span class="p">)]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, the Bezier curve for our three control points would look something like this:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">colors_red_to_green</span> <span class="o">=</span> <span class="p">[</span><span class="n">bezier_point</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="n">red</span><span class="p">,</span> <span class="n">blue</span><span class="p">,</span> <span class="n">green</span><span class="p">])</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ts</span><span class="p">]</span>

<span class="n">curve_data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors_red_to_green</span><span class="p">:</span>
    <span class="n">curve_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
                                <span class="n">x</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">y</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                <span class="n">z</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                                            <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                                            <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span>
                                            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                                            <span class="n">width</span><span class="o">=</span><span class="mi">1</span>
                                                    <span class="p">)</span>
                                            <span class="p">)</span>
                                    <span class="p">)</span>
                        <span class="p">)</span>
    
<span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">+</span><span class="n">curve_data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
<span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[40]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;" seamless="seamless" src="https://plot.ly/~russodanielp/40.embed" height="525px" width="100%"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We are left with a much nicer looking color gradient using a Bezier curve.  Many thanks to Nastassia Pouradier Duteil for working through the math with me.  I'll link to her bio once she gets a homepage!</p>

</div>
</div>
</div></p>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="https://russodanielp.github.io/plotting-a-heatmap-with-a-dendrogram-using-bokeh.html" rel="bookmark"
                           title="Permalink to Plotting a Heatmap with a Dendrogram Using Bokeh">Plotting a Heatmap with a Dendrogram Using Bokeh</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-09-09T15:57:00-04:00">
                Published: Fri 09 September 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://russodanielp.github.io/author/daniel-p-russo.html">Daniel P. Russo</a>
        </address>
<p>In <a href="https://russodanielp.github.io/category/python.html">Python</a>.</p>
<p>tags: <a href="https://russodanielp.github.io/tag/basell.html">basell</a> <a href="https://russodanielp.github.io/tag/python.html">python</a> </p>
</footer><!-- /.post-info -->                <p>Plotting a Heatmap with a Dendrogram Using Bokeh</p>
                <a class="readmore" href="https://russodanielp.github.io/plotting-a-heatmap-with-a-dendrogram-using-bokeh.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://russodanielp.github.io/a-brief-introduction-to-smarts-using-rdkit.html" rel="bookmark"
                           title="Permalink to A brief introduction to SMARTS using RDKit">A brief introduction to SMARTS using RDKit</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-07-11T18:32:00-04:00">
                Published: Mon 11 July 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://russodanielp.github.io/author/daniel-p-russo.html">Daniel P. Russo</a>
        </address>
<p>In <a href="https://russodanielp.github.io/category/python.html">Python</a>.</p>
<p>tags: <a href="https://russodanielp.github.io/tag/rdkit.html">rdkit</a> <a href="https://russodanielp.github.io/tag/python.html">python</a> <a href="https://russodanielp.github.io/tag/drugbank.html">drugbank</a> <a href="https://russodanielp.github.io/tag/smarts.html">SMARTS</a> </p>
</footer><!-- /.post-info -->                <p>A brief introduction to SMARTS using RDKit</p>
                <a class="readmore" href="https://russodanielp.github.io/a-brief-introduction-to-smarts-using-rdkit.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://russodanielp.github.io/exploring-drugbank-using-rdkit.html" rel="bookmark"
                           title="Permalink to Exploring DrugBank using RDKit">Exploring DrugBank using RDKit</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-06-08T19:44:00-04:00">
                Published: Wed 08 June 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://russodanielp.github.io/author/daniel-p-russo.html">Daniel P. Russo</a>
        </address>
<p>In <a href="https://russodanielp.github.io/category/python.html">Python</a>.</p>
<p>tags: <a href="https://russodanielp.github.io/tag/rdkit.html">rdkit</a> <a href="https://russodanielp.github.io/tag/python.html">python</a> <a href="https://russodanielp.github.io/tag/drugbank.html">drugbank</a> </p>
</footer><!-- /.post-info -->                <p>Exploring DrugBank using RDKit.</p>
                <a class="readmore" href="https://russodanielp.github.io/exploring-drugbank-using-rdkit.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://russodanielp.github.io/phillies-vs-nationals.html" rel="bookmark"
                           title="Permalink to Phillies vs. Nationals">Phillies vs. Nationals</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-04-30T14:00:00-04:00">
                Published: Sat 30 April 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://russodanielp.github.io/author/daniel-p-russo.html">Daniel P. Russo</a>
        </address>
<p>In <a href="https://russodanielp.github.io/category/python.html">Python</a>.</p>
<p>tags: <a href="https://russodanielp.github.io/tag/baseball.html">baseball</a> <a href="https://russodanielp.github.io/tag/python.html">python</a> </p>
</footer><!-- /.post-info -->                <p>Looking at the Phillies Nationals series using mlbgame.</p>
                <a class="readmore" href="https://russodanielp.github.io/phillies-vs-nationals.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://russodanielp.github.io/2015-mlb-batting-and-pitching.html" rel="bookmark"
                           title="Permalink to 2015 MLB Batting and Pitching">2015 MLB Batting and Pitching</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-02-28T16:50:00-05:00">
                Published: Sun 28 February 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://russodanielp.github.io/author/daniel-p-russo.html">Daniel P. Russo</a>
        </address>
<p>In <a href="https://russodanielp.github.io/category/python.html">Python</a>.</p>
<p>tags: <a href="https://russodanielp.github.io/tag/baseball.html">baseball</a> <a href="https://russodanielp.github.io/tag/python.html">python</a> </p>
</footer><!-- /.post-info -->                <p>First post Bokeh graphs with MLB batting and pitching data</p>
                <a class="readmore" href="https://russodanielp.github.io/2015-mlb-batting-and-pitching.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://zhu.camden.rutgers.edu/">Zhu Research Group</a></li>
                            <li><a href="https://ccib.camden.rutgers.edu/">Rutgers Center for Computational and Integrative Biology</a></li>
                            <li><a href="ciipro.rutgers.edu">CIIPro: The Chemical In vitro-In vivo Profiling Project</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://twitter.com/russodanielp">@russodanielp</a></li>
                            <li><a href="https://www.linkedin.com/in/daniel-russo-31ab896b">/danielprusso</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>